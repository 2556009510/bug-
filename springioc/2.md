**目录**

[1、](#1、)

[1.2：](#1.2：)

[1.3： 解决在1和2中“用户服务”重复添加代码比较麻烦的问题（因为只允许开一个）](#1.3： 解决在1和2中“用户服务”重复添加代码比较麻烦的问题（因为只允许开一个）)

[1.4、](#1.4、)

[2、IOC控制反转：（设计思想：通过中介）](#2.1、IOC控制反转：（设计思想：通过中介）)

[2.1、跟上面的第三方相似](#2.1、跟上面的第三方相似)

[2.2、DI与IOC：](#2.2、DI与IOC：)

[2.3、图](#2.3、图)

[2.4、spring每个绿框都是对应不同模块：](#2.4、spring每个绿框都是对应不同模块：)

[3、](#3、)

[3.1、测试：](#3.1、测试：)

[3.2、maven仓库的分类：](#3.2、maven仓库的分类：)

[3.3、创建文件：](#3.3、创建文件：)

[3.4、](#3.4、)

[3.4.1、获取属性：](#3.4.1、获取属性：)

[3.4.2、通过构造器给对象赋值：](#3.4.2、通过构造器给对象赋值：)

[3.4.3、 对命名空间为bean的标签进行赋值，简化配置文件中属性声明的写法：](#3.4.3、 对命名空间为bean的标签进行赋值，简化配置文件中属性声明的写法：)

[3.4.4、 为复杂类型进行赋值操作](#3.4.4、 为复杂类型进行赋值操作)

[3.4.5、 继承关系bean的配置（bean之间的继承关系）](#3.4.5、 继承关系bean的配置（bean之间的继承关系）)

[3.4.6、 bean对象创建的依赖关系](#3.4.6、 bean对象创建的依赖关系)

[3.4.7、 bean的作用域控制，是否是单例](#3.4.7、 bean的作用域控制，是否是单例)

[3.4.8、 利用工厂模式创建bean对象](#3.4.8、 利用工厂模式创建bean对象)

[3.4.9、 继承FactoryBean（工厂豆）来创建对象](#3.4.9、 继承FactoryBean（工厂豆）来创建对象)

[3.4.10、 bean对象的初始化和销毁方法](#3.4.10、 bean对象的初始化和销毁方法)

[3.4.11、 配置bean对象初始化方法的前后处理方法](#3.4.11、 配置bean对象初始化方法的前后处理方法)

[](#)

------

# 1、

普通创建项目方式：

![img](https://img-blog.csdnimg.cn/20200709132928950.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****UserDao****（用户访问接口）**

```java
public interface UserDao {
    public void getUser();
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：** **UserDaoImpl****（用户访问）**

```java
public class UserDaoImpl implements UserDao {
    @Override
    public void getUser() {
        System.out.println("获取用户");    }
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****UserService****（用户服务接口）**

```java
public interface UserService {
    public void getUser();
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****UserServiceImpl****（用户服务）**

```java
public class UserServiceImpl implements UserService {
============================= 1、 ===================================
//    private UserDao userDao = new UserDaoImpl(); //只能开一个
============================= 2、 ===================================
//    private UserDao userDao = new UserDaoMysqlImpl(); //只能开一个
============================= 3、 ===================================
    private UserDao userDao;
    public void setUserDao(UserDao userDao){
        this.userDao = userDao;
    }
=====================================================================
    @Override
    public void getUser() {
        userDao.getUser();
    }
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****MyText****（测试）**

```java
public class MyTest {
    public static void main(String[] args) {
============================= 1、 ===================================
        UserServiceImpl userService = new UserServiceImpl();
        userService.getUser();
============================= 3、 ===================================
第三方：UserDaoMysqlImpl userDaoMysql = new UserDaoMysqlImpl();
        userService.setUserDao(userDaoMysql);
        userService.getUser();
============================= 4、 ===================================
        userService.getUser();
        System.out.println("--------------");
        UserDaoOracleImpl userDaoOracle = new UserDaoOracleImpl();
        userService.setUserDao(userDaoOracle);
        userService.getUser();
=====================================================================
    }
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**（四种获取方式）**

**都是：**![img](https://img-blog.csdnimg.cn/20200709133258905.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

## 1.2：

![img](https://img-blog.csdnimg.cn/2020070913340951.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****UserDaoMysqlImpl****（用户访问Mysql）**

```java
public class UserDaoMysqlImpl implements UserDao {
    @Override
    public void getUser() {
        System.out.println("从mysql获取数据");
    }
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709133430572.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

## **1.3****：** 解决在1和2中**“****用户服务****”重复添加代码比较麻烦的问题****（因为只允许开一个）**

![img](https://img-blog.csdnimg.cn/20200709133458547.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/2020070913350369.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

## 1.4、

**java****文件：****UserDaoOracleImpl****（用户访问Oracle）**

```java
public class UserDaoOracleImpl implements UserDao {
    @Override
    public void getUser() {
        System.out.println("从oracle中获取数据");
    }
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709133529811.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

# **2****、****IOC****控制反转：****（设计思想：通过中介）**

## **2.1、跟上面的第三方相似**

**1****、谁控制谁：**在之前的编码过程中，都是需要什么对象自己去创建什么对象，有程序员自己来控制对象，而有了IOC容器之后，就会变成由IOC容器来控制对象，

**2****、控制什么：**在实现过程中所需要的对象及需要依赖的对象

**3****、什么是反转：**在没有IOC容器之前我们都是在对象中主动去创建依赖的对象，这是正转的，而有了IOC之后，依赖的对象直接由IOC容器创建后注入到对象中，由主动创建变成了被动接受，这是反转

**4****、哪些方面被反转：**依赖的对象

## **2.2****、****DI****与IOC：**

很多人把IOC和DI说成一个东西，笼统来说的话是没有问题的，但是本质上还是有所区别的,希望大家能够严谨一点，IOC和DI是从不同的角度描述的同一件事，IOC是从容器的角度描述，而DI是从应用程序的角度来描述，也可以这样说，IOC是设计思想，而DI是具体的实现方式

## **2.3****、图**

![img](https://img-blog.csdnimg.cn/20200709133928326.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==) **解决方式→** ![img](https://img-blog.csdnimg.cn/20200709133953585.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

无论是架构师还是程序员，在面临这样的场景的时候，都需要减少这些对象的耦合性：

![img](https://img-blog.csdnimg.cn/20200709134013784.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

​       从上图中可以看到，当引入了第三方的容器之后，几个对象之间就没有了耦合关系，全部对象都交由容器来控制，这个**容器**就相当于粘合剂，将系统的对象粘合在一起发挥作用。

## 2.4、spring每个绿框都是对应不同模块：

![img](https://img-blog.csdnimg.cn/20200709134046455.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**从下往上创建：**

Core Container（IOC反转）

# 3、

## **3.1****、测试：**

![img](https://img-blog.csdnimg.cn/20200709134114318.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134120314.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134126458.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**导入包后，里面会多出一个选项**

**java****文件：****Person****（个人）**

```java
private int id;
    private String name;
    private int age;
    private String gender;

    public Person() {
        System.out.println("person被创建");
    }
    public int getId() {return id;}
    public void setId(int id) {this.id = id;}

    public String getName() {return name;}
    public void setName(String name) {this.name = name;}

    public int getAge() {return age;}
    public void setAge(int age) {this.age = age;}

    public String getGender() {return gender;}
    public void setGender(String gender) {this.gender = gender;}

    @Override
    public String toString() {
        return "Person{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", age=" + age +
                ", gender='" + gender + '\'' +
                '}';
    }
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

```html
bean标签：表示要创建的bean对象
id:唯一标识，为了跟其他的bean标签区分
class:表示要创建的bean的完全限定名

property标签：给属性赋值使用
name:表示属性的名称
value：表示具体的属性值

<bean id="person" class="com.mashibing.bean.Person">
    <property name="id" value="1"></property>
    <property name="name" value="zhangsan"></property>
    <property name="age" value="20"></property>
    <property name="gender" value="男"></property>
 </bean>
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****MyText****（测试）**

```java
ApplicationContext:表示IOC容器的入口，想要获取对象的话，必须要创建该类
该类有两个读取配置文件的实现类（相当于中介）：
ClassPathXmlApplicationContext:表示从classpath中读取数据
FileSystemXmlApplicationContext:表示从当前文件系统读取数据

public class MyTest {
    public static void main(String[] args) {
        //Person person = new Person();
        //System.out.println(person);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134303213.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```java
        ApplicationContext context = new ClassPathXmlApplicationContext("ioc.xml");
//获取具体的bean实例对象，需要进行强制类型转换
        //Person person = (Person) context.getBean("person");

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134321923.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```java
//获取对象的时候不需要强制类型转换
        Person person = context.getBean("person", Person.class);
        System.out.println(person);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134341902.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```java
    }
}

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

容器中的person对象是什么时候创建的？
容器中的对象在容器创建完成之前就已经把对象创建好了

![img](https://img-blog.csdnimg.cn/20200709134408753.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

## **3.2****、****maven****仓库的分类：**

​       **本地仓库：**本地仓库就是开发者本地已经下载下来的或者自己打包所有jar包的依赖仓库，本地仓库路径配置在maven对应的conf/settings.xml配置文件。

​       **私有仓库：**私有仓库可以理解为自己公司的仓库，也叫Nexus私服

​       **中央仓库：**中央仓库即maven默认下载的仓库地址，是maven维护的

**说明：私有仓库需要每天维护，将外面与内部相关的信息、地址不断修改**





**maven****常用命令：**

- **clean****：**清理编译后的目录
- **compile****：**编译，只编译main目录，不编译test中的代码
- **test-compile****：**编译test目录下的代码
- **test****：**运行test中的代码
- **package****：**打包，将项目打包成jar包或者war包
- **install****：**发布项目到本地仓库用在打jar包上，打成的jar包可以被其他项目使用
- **deploy****：**打包后将其安装到pom文件中配置的远程仓库
- **site****：**生成站点目录

## **3.3****、****创建文件：**

![img](https://img-blog.csdnimg.cn/20200709134651276.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/2020070913465953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134702511.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/2020070913470663.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134709860.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134713496.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134717571.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134721179.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**打开：**![img](https://img-blog.csdnimg.cn/20200709134726586.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134729921.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134736912.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709134741237.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

## **3.4****、**

### **3.4.1****、获取属性：**

**java****文件：****Person****（个人）**

```java
private int id;
    private String name;
    private int age;
    private String gender;
========================= 利用的是构造器 ============================
    public Person() {
        System.out.println("person被创建");
    }
=====================================================================
    public int getId() {return id;}
    public void setId(int id) {this.id = id;}

    public String getName() {return name;}
    public void setName(String name) {this.name = name;}

    public int getAge() {return age;}
    public void setAge(int age) {this.age = age;}

    public String getGender() {return gender;}
    public void setGender(String gender) {this.gender = gender;}

    @Override
    public String toString() {
        return "Person{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", age=" + age +
                ", gender='" + gender + '\'' +
                '}';
    }
}

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

```html
<bean id="parent" class="com.mashibing.bean.Person" abstract="false"> 
        <property name="id" value="1"></property>
        <property name="name" value="zhangsan"></property>
        <property name="age" value="20"></property>
        <property name="gender" value="男"></property>
    </bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****Mytest****（测试）**

```java
public class MyTest {
    public static void main(String[] args) {
        ApplicationContext context = new ClassPathXmlApplicationContext("ioc.xml");
        /*根据bean标签的id来获取对象*/
     Person person = context.getBean("person", Person.class);
     System.out.println(person);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709135222580.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```
========================= 2、（多例模式）============================
     //Person person2 = context.getBean("person",Person.class);
     //System.out.println(person == person2);  
=====================================================================

//上面是通过id：person获取属性
//下面是直接获取整个类的属性（如果存在同名的id会报错）
     //Person bean = context.getBean(Person.class);
     //System.out.println(bean);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709135551361.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**细节点：**

​       **1****、**对象在Spring容器创建完成的时候就已经创建完成，不是需要用的时候才创建，这种情况值满足单例模式![img](https://img-blog.csdnimg.cn/20200709135609279.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==) **（容器中创建）**

​       **2****、**单例与多例

![img](https://img-blog.csdnimg.cn/20200709135624675.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)![img](https://img-blog.csdnimg.cn/20200709135628675.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

​       **3****、**给属性赋值的时候是通过容器中的set方法实现的

​        **4****、**对象的属性是由set/get方法决定的，而不是定义的成员属性

**总结：获取属性的三种方式：**

1、（之前已经讲了）

2、ApplicationContext，通过id：person获取属性

3、ApplicationContext，通过类整个类获取属性

### **3.4.2****、****通过构造器给对象赋值：**

**java****文件：****Person****（个人）**

**添加****构造器：**

```java
public Person(int id, String name, Integer age, String gender) {
    this.id = id;
    this.name = name;
    this.age = age;
    this.gender = gender;
}

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

**方式一：**

```html
<bean id="person2" class="com.mashibing.bean.Person">
    <constructor-arg name="id" value="2"></constructor-arg>
    <constructor-arg name="name" value="lisi"></constructor-arg>
    <constructor-arg name="age" value="22"></constructor-arg>
    <constructor-arg name="gender" value="男"></constructor-arg>
</bean>
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709135857804.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**方式二：****（前面讲了）**

![img](https://img-blog.csdnimg.cn/2020070913591377.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**方式三：**

![img](https://img-blog.csdnimg.cn/20200709135930698.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)**（位置交换）**![img](https://img-blog.csdnimg.cn/20200709135930745.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)**（结果的位置也交换）**

**java****文件：****Mytest****（测试）**

![img](https://img-blog.csdnimg.cn/20200709135948911.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc****（但是要注意里面的顺序，如果顺序不一致的话，可以用index索引到那个值）**

```html
<bean id="person3" class="com.mashibing.bean.Person">
    <constructor-arg  value="2"></constructor-arg>
    <constructor-arg  value="男" index="3"></constructor-arg>
    <constructor-arg  value="22"></constructor-arg>
    <constructor-arg  value="lisi" index="1"></constructor-arg>
</bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709140020182.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

name:表示参数列表的名称
value:表示实际的具体值
type:表示值的类型
index:表示值的下标，从0开始

**==========================================**

**java****文件：****Person****（个人）****创建有参构造方法：**

![img](https://img-blog.csdnimg.cn/20200709140053124.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)![img](https://img-blog.csdnimg.cn/20200709140053137.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709140057877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****Mytest****（测试）**

![img](https://img-blog.csdnimg.cn/20200709140106343.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

```html
<bean id="person4" class="com.mashibing.bean.Person">
    <constructor-arg  value="4"></constructor-arg>
    <constructor-arg  value="wangwu"></constructor-arg>
    <constructor-arg  value="22" type="java.lang.Integer">
</constructor-arg>
</bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**先执行下面构造函数，执行是有顺序的：**

![img](https://img-blog.csdnimg.cn/20200709140133184.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**//****构造方法交换位置：**

![img](https://img-blog.csdnimg.cn/20200709140143799.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709140146799.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**解决办法：**![img](https://img-blog.csdnimg.cn/20200709140152323.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)**（一般用在id后面）**



总结：

在日常工作中，一般都是用name,value的方式，很少有人去使用index或者type的方式，但是要注意各种情况出现的问题

### **3.4.3****、** 对命名空间为bean的标签进行赋值，简化配置文件中属性声明的写法：

**xml****文件：****ioc**

**1****、导入命名空间：**

![img](https://img-blog.csdnimg.cn/20200709140346903.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTA0MjU2OQ==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**2****、添加配置：**

```bash
使用p命名空间来给属性赋值：

<bean id="person5" class="com.mashibing.bean.Person" 
p:id="5" 
p:name="wangwu"
p:age="25" 
p:gender="女">
</bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****Mytest****（测试）**

```java
Person person5 = context.getBean("person5", Person.class);
System.out.println(person5);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709140439782.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

### **3.4.4****、** 为复杂类型进行赋值操作

**java****文件：****Person****（个人）**

```java
public class Person {
    private int id;
    private String name;
    private Integer age;
    private String gender;    
=========================== 从这里开始 ==============================
    private String[] hobbies; 1、 数组
    private Address address;  2、 引用

    private List<Address> lists; 3、 获取对象的值
    private Set<String> sets;    4、 给数组赋值
    private Map<String,Object> maps; 5、 赋值
    private Properties properties;   6、 赋值

    //public Person() {System.out.println("person被创建");}
    public Person(int id, String name, Integer age, String gender) {
        this.id = id;
        this.name = name;
        this.age = age;
        this.gender = gender;
    }
    public Person(int id, String name, Integer age) {
        this.id = id;
        this.name = name;
        this.age = age;
        System.out.println("age......");
    }
    public Person(int id, String name, String gender) {
        this.id = id;
        this.name = name;
        this.gender = gender;
        System.out.println("gender.....");
    }
    public int getId() {return id;}
    public void setId(int id) {this.id = id;}

    public String getName() {return name;}
    public void setName(String name) {this.name = name;}

    public Integer getAge() {return age;}
    public void setAge(Integer age) {this.age = age;}

    public String getGender() {return gender;}
    public void setGender(String gender) {this.gender = gender;}

    public String[] getHobbies() {return hobbies;}
    public void setHobbies(String[] hobbies){this.hobbies = hobbies;}

    public Address getAddress() {return address;}
    public void setAddress(Address address) {this.address = address;}

    public List<Address> getLists() {return lists;}
    public void setLists(List<Address> lists) {this.lists = lists;}

    public Set<String> getSets() {return sets;}
    public void setSets(Set<String> sets) {this.sets = sets;}

    public Map<String, Object> getMaps() {return maps;}
    public void setMaps(Map<String, Object> maps) {this.maps = maps;}

    public Properties getProperties() {return properties;}
    public void setProperties(Properties properties) {
        this.properties = properties;
    }
    @Override
    public String toString() {
        return "Person{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", age=" + age +
                ", gender='" + gender + '\'' +
                ", hobbies=" + Arrays.toString(hobbies) +
                ", address=" + address +
                ", lists=" + lists +
                ", sets=" + sets +
                ", maps=" + maps +
                ", properties=" + properties +
                '}';
    }
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****Address****（住址）**

```java
public class Address {
    private String province; //省
    private String city; //市
    private String town; //城

    public Address() {System.out.println("address被创建");}
    public String getProvince() {return province;}
    public void setProvince(String province) {
        this.province = province;
    }

    public String getCity() {return city;}
    public void setCity(String city) {this.city = city;}

    public String getTown() {return town;}
    public void setTown(String town) {this.town = town;}
    @Override
    public String toString() {
        return "Address{" +
                "province='" + province + '\'' +
                ", city='" + city + '\'' +
                ", town='" + town + '\'' +
                '}';
    }
}

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****Mytest****（测试）**

```java
    Person person6 = context.getBean("person6", Person.class);
    System.out.println(person6);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

```html
<bean id="person6" class="com.mashibing.bean.Person">
        <property name="id" value="6"></property>
        <property name="name" value="zhangsan6"></property>
        <property name="age" value="26"></property>
        <property name="gender" value="男6"></property>
=============================== 1、 =================================

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

//给数组赋值![img](https://img-blog.csdnimg.cn/20200709140645896.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
方式一：<property name="hobbies" value="book,girl,movie"></property>
方式二：<property name="hobbies">
            <array>
                <value>book</value>
                <value>girl</value>
                <value>movie</value>
            </array>
        </property>
=============================== 2、 =================================
//给引用类型赋值,可以使用ref引入外部bean
//address（住址类），ref（引用）
        <bean id="address" class="com.mashibing.bean.Address">
            <property name="address" ref="address"></property></bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
            <property name="lists" value="1,2,3"></property>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```bash
        </bean>
        <bean id="address" class="com.mashibing.bean.Address">
            <property name="province" value="河北省"></property>
            <property name="city" value="邯郸"></property>
            <property name="town" value="武安"></property>
        </bean>
=============================== 3、 =================================
        <property name="lists">
           <list>
//使用内部bean,无法从IOC容器中直接获取对象的值（<bean后面不能加id="address2"）
              <bean class="com.mashibing.bean.Address">
                   <property name="province" value="北京"></property>
              </bean>
              <bean class="com.mashibing.bean.Address">
                   <property name="province" value="上海"></property>
              </bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709140940458.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141017916.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)![img](https://img-blog.csdnimg.cn/20200709141022401.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
=====================================================================
//使用外部bean，可以随意从IOC容器获取对象的值（随意）
              <ref bean="address"></ref>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141042453.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
           </list>
        </property>
=============================== 4、 =================================
//给set属性赋值
        <property name="sets">
            <set>
                <value>zhangsan</value>
                <value>zhangsan</value>
                <value>lisi</value>
            </set>
        </property>
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141058646.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
=============================== 5、 =================================
//给map赋值
        <property name="maps">
            <map>
                <entry key="a" value="aaa"></entry>
//引用：--------<entry key="address" value-ref="address"></entry>
                <entry key="address2">
//在自己内部创建对象<bean class="com.mashibing.bean.Address">
                        <property name="province" value="广东省">
</property>
                    </bean>
                </entry>
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141117900.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141121902.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
               <entry>              
                    <key>
                        <value>heihei</value>
                    </key>
                    <value>haha</value>
                </entry>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141238177.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
                <entry key="list">                
                    <list>
                        <value>11</value>
                        <value>22</value>
                    </list>
                </entry>
            </map>
        </property>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141217582.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

也可用利用文档方式：![img](https://img-blog.csdnimg.cn/20200709141312369.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)![img](https://img-blog.csdnimg.cn/20200709141316150.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

### **3.4.5****、** 继承关系bean的配置（bean之间的继承关系）

如果想实现Java文件的抽象类，不需要将当前bean实例化的话，可以使用abstract属性

**xml****文件：****ioc**

```html
//可以使用abstract标签定义抽象bean，但无法进行实例化
<bean id="parent" class="com.mashibing.bean.Person" abstract="false">
    <property name="id" value="1"></property>
    <property name="name" value="zhangsan"></property>
    <property name="age" value="20"></property>
    <property name="gender" value="男"></property>
</bean>

//可以通过parent属性来获取父bean中的某些属性值
<bean id="son" class="com.mashibing.bean.Person" parent="parent">
    <property name="name" value="haha"></property>
</bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****Mytest****（测试）**

```java
    Person son = context.getBean("son", Person.class);
    System.out.println(son);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141421445.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**ico.xml****中添加：**parent="parent"

![img](https://img-blog.csdnimg.cn/20200709141436774.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****Mytest****（测试）**

```java
    Person parent = context.getBean("parent", Person.class);
    System.out.println(parent);
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**ico.xml****中添加：**abstract="false"（teun是用于实例化）

![img](https://img-blog.csdnimg.cn/20200709141507753.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

### **3.4.6****、** **bean****对象创建的依赖关系**

**添加：**

![img](https://img-blog.csdnimg.cn/20200709141527936.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

如果需要干扰创建的顺序，可以使用depends-on属性![img](https://img-blog.csdnimg.cn/20200709141652216.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
    <bean id="address" class="com.mashibing.bean.Address" depends-on
="person"></bean>
    <bean id="person" class="com.mashibing.bean.Person"></bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
//

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141711228.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)（ioc.xml代码的顺序与该顺序是相关的）

### **3.4.7****、** **bean****的作用域控制，是否是单例**

**bean****的作用域：singleton、prototype、request、session**

默认情况下是单例

**singleton****（单例）**：默认的单例对象，IOC容器启动完成之前就已经创建好对象,获取的都是同一个对象

**prototype****（多例）**：多实例

​        IOC容器启动的时候不会创建多实例bean，只有在获取对象的时候才会创建该对象，每次创建都是一个新的对象

**另外两个作用域：request、session（在spring5.x的版本就去掉了）**

**request****（请求）****：**每次发送请求都会有一个新的对象

**session****：（会话）**每一个会话都会有一个新的对象（默认是30分钟，不做任何操作会消失）



**xml****文件：****ioc**

```html
//设置bean对象的作用域
    <bean id="person2" class="com.mashibing.bean.Person" scope(范围)=
"singleton"></bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：****Mytest****（测试）**

```java
    Person parent2 = context.getBean("parent2", Person.class);
Person parent3 = context.getBean("parent3", Person.class);
    System.out.println(parent2 == parent3);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141850958.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

换成：scope(范围)="prototype"时，为![img](https://img-blog.csdnimg.cn/20200709141856241.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709141902879.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)（上面java代码需要用到，person就立即创建）

**singleton****（单例）**：每次在创建IOC容器完成之前此对象已经创建完成

**prototype****（多例）**：每次是在需要用到此对象的时候才会创建

### **3.4.8****、** **利用工厂模式创建****bean****对象**

![img](https://img-blog.csdnimg.cn/20200709141932919.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

在利用工厂模式创建bean实例的时候有两种方式：

​       **静态工厂**：工厂本身不需要创建对象，但是可以通过静态方法调用

对象 = 工厂类**.**静态工厂方法名（）；



​       **实例工厂**：工厂本身需要创建对象

工厂类 工厂对象 = new 工厂类；

工厂对象**.**get对象名（）；

**java****文件：**PersonStaticFactory**（静态工厂）**

```java
public class PersonStaticFactory {
    public static Person getInstance(String name){
        Person person = new Person();
        person.setId(1);
        person.setName(name);
        person.setAge(11);
        return person;
    }
}

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：**PersonInstanceFactory**（实例工厂）**

```java
public class PersonInstanceFactory {
    public Person getInstance(String name){
        Person person = new Person();
        person.setId(2);
        person.setName(name);
        person.setAge(22);
        return person;
    }
}

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

```html
============================ 静态工厂 ===============================
    <bean id="person2" class="com.mashibing.bean.Person" scope=
"singleton">
</bean>

//利用工厂方法创建bean
//静态工厂：类名.静态方法（）
//factory-bean:工厂类的实例
//factory-method:工厂实例的方法

    <bean id="person" class=
"com.mashibing.factory.PersonStaticFactory" factory-method=
"getInstance"> //getInstance工厂方法
        <constructor-arg value="zhangsan"></constructor-arg>
    </bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709142052905.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
============================ 实例工厂 ===============================
//实例工厂：先创建工厂实例，然后调用工厂实例的方法

    <bean id="instanceFactory(实例工厂)" class=
"com.mashibing.factory.PersonInstanceFactory"></bean>
    <bean id="person2" class="com.mashibing.bean.Person" 
factory-bean="instanceFactory(实例工厂)" factory-method="getInstance"> //getInstance工厂方法
        <constructor-arg value="lisi"></constructor-arg>
    </bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709142109174.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：**MyText**（测试）**

```java
============================ 静态工厂 ===============================
Person person = context.getBean("person", Person.class);
    System.out.println(person);
============================ 实例工厂 ===============================
Person person2 = context.getBean("person2", Person.class);
    System.out.println(person);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

### **3.4.9****、** **继承****FactoryBean****（工厂豆）来创建对象**

Spring都会将其作为一个工厂，但是在ioc容器启动的时候不会创建实例，只有在使用的时候才会创建对象（相当于**prototype**多例）



**java****文件：**MyFactoryBean**（工厂豆）**

```java
public class MyFactoryBean implements FactoryBean<Person> {
//返回获取的bean
    public Person getObject() throws Exception {
        Person person = new Person();
        person.setId(3);
        person.setName("王五");
        return person;
    }
//获取返回bean的类型
    public Class<?> getObjectType() {
        return Person.class;
    }
//判断当前bean是否是单例的
    public boolean isSingleton() {
        return true;
    }
}

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

```html
    <bean id="myFactoryBean" class=
"com.mashibing.factory.MyFactoryBean">
    </bean>

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：**MyText**（测试）**

```java
Person myFactoryBean = context.getBean("myFactoryBean",Person.class);
System.out.println(myFactoryBean);

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709142309803.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

### **3.4.10****、** **bean****对象的初始化和销毁方法**

![img](https://img-blog.csdnimg.cn/20200709142333638.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java文件：Person（个人）**

```java
public void init(){
·
·
·
//编写N行逻辑代码完成初始化功能
    System.out.println("person对象初始化完成");
}
public void destory(){
    System.out.println("person对象被销毁");
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

```html
spring容器在创建对象的时候可以指定具体的初始化和销毁方法：
init-method:在对象创建完成之后会调用初始化方法
destory-method:在容器关闭的时候会调用销毁方法

<bean id="person" class="com.mashibing.bean.Person"
init-method="init(初始化)" destroy-method="destory(销毁)" scope="singleton(单例)"> 

初始化和销毁的方法跟scope属性也是相关联的：
如果是singleton(单例)的话，初始化和销毁的方法都显示
如果是prototype(多例)的话，初始化方法会调用，但是销毁的方法不会显示
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**java****文件：**MyText**（测试）**

```java
Person person = context.getBean("person", Person.class);
    System.out.println(person);
//一般关闭对象用：context.close();
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709142454351.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)因为context对应ioc文件

//但是这里关闭用的是另一种：

```java
  ((ClassPathXmlApplicationContext)context).close();  

```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709142537863.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709142541725.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

### **3.4.11****、** **配置****bean****对象初始化方法的前后处理方法**

### ![img](https://img-blog.csdnimg.cn/20200709142556223.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

spring中包含一个BeanPostProcessor的接口，可以在bean的初始化方法的前后调用该方法，如果配置了初始化方法的前置和后置处理器，无论是否包含初始化方法，都会进行调用

**java****文件：**MyBeanPostProcessor**（豆布置处理器）**

```java
public class MyBeanPostProcessor implements BeanPostProcessor {
    /**
     * 在每一个对象的初始化方法前面执行
     * @param bean:表示创建的具体对象
     * @param beanName:表示bean的id属性
     * @return
     * @throws BeansException
     */
    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {

System.out.println("postProcessBeforeInitialization:"+beanName);
        return bean;
    }
    /**
     * 在每一个对象的初始化方法后面执行
     * @param bean
     * @param beanName
     * @return
     * @throws BeansException
     */
    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {

System.out.println("postProcessAfterInitialization:"+beanName);
     return bean;
    }
}
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**xml****文件：****ioc**

```html
<bean id="myBeanPostProcessor" class="com.mashibing.bean.MyBeanPostProcessor">
</bean>
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709142651531.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

```html
<bean id="aAddress" class="com.mashibing.bean.Address"></bean>
```

![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

![img](https://img-blog.csdnimg.cn/20200709142709296.png)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)



------

 
